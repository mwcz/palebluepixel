<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>    Raspberry Pi Timelapse Camera - Pale Blue Pixel
</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#171717">
    <link rel="icon" type="image/png" href="/static/images/favicon.png">


        <!-- Open Graph tags -->
            <meta property="og:type" content="article"/>
            <meta property="og:title" content="Raspberry Pi Timelapse Camera"/>
            <meta property="og:url" content="https://palebluepixel.org/drafts/raspberry-pi-timelapse-camera.html"/>
            <meta property="og:description" content="I built a timelapse camera with a raspberry pi. Hardware: A small gorillapod Raspbery Pi camera Raspberry Pi Model B â€¦"/>
            <meta property="og:image"
                  content="https://palebluepixel.org{attach}scene_morning_light.jpg"/>


    <!--[if gte IE 9]
    <style type="text/css">
        .gradient {
            filter: none;
        }
    </style>
    <![endif]-->

    <!-- <link href='http://fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'> -->
    <link href="https://palebluepixel.org/theme/css/styles.min.css" rel="stylesheet">

    <!-- JavaScript plugins (requires jQuery) -->
    <script src="https://palebluepixel.org/theme/js/jquery.min.js"></script>
    <script src="https://palebluepixel.org/theme/js/jquery.lightbox.min.js"></script>

    <link href="https://palebluepixel.org/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
          title="Pale Blue Pixel ATOM Feed"/>
    <link href="https://palebluepixel.org/feeds/rss.xml" type="application/atom+xml" rel="alternate"
          title="Pale Blue Pixel RSS Feed"/>


</head>
<body>
<div class="container">
    <div class="row">
        <div class="col-xs-12">
            <nav class="pbp-navbar" role="navigation">
                <a href="https://palebluepixel.org" title="Pale Blue Pixel homepage" id="pbp-logo">
                    PALE BL<span class="pbp-dot">&middot;</span>UE PIXEL
                </a>
            </nav>
        </div>
    </div>
</div>
<!-- /.navbar -->
<main role="main" class="container">
    <article>


        <header class="page-header">
            <h1>
                Raspberry Pi Timelapse Camera
            </h1>
        </header>
        <div class="entry-content">
            <nav class="toc"></nav>
            <p>I built a timelapse camera with a raspberry pi.</p>
<p>Hardware:</p>
<ul>
<li><a href="http://amzn.com/B008YE0HAW">A small gorillapod</a></li>
<li><a href="http://www.raspberrypi.org/products/camera-module/">Raspbery Pi camera</a></li>
<li><a href="https://en.wikipedia.org/wiki/Raspberry_Pi">Raspberry Pi Model B</a></li>
</ul>
<p>Software:</p>
<p>The scripts I wrote are pretty hasty.  I should tidy them up before publishing
this post.</p>
<p><img alt="Timelapse scene" src="https://palebluepixel.org/drafts/scene_morning_light.jpg" title="Timelapse scene" /></p>
<p>I didn't secure the pi very well when I first framed the shot, and it wound up
getting bumped several times.  Lesson learned: make sure </p>
<h2>File naming</h2>
<p>I used Epoch time for the filenames.</p>
<div class="codehilite"><pre><span></span>1396020890.jpg
1396021196.jpg
1396021502.jpg
1396021808.jpg
</pre></div>


<p>This was a spontaneous decision, chosen for convenience, but turned out to have
some unexpected benefits.</p>
<p>Eliminating night-time shots was </p>
<p>Doing some modulo math on the epoch times made isolating the dark hours easy.
Since Epoch time is measured in seconds, all we need to know is the number of
seconds in a minute, hour, and day.</p>
<div class="codehilite"><pre><span></span># number of seconds in a minute/hour/day
minute = 60
hour   = 3600
day    = 86400
</pre></div>


<p>Now that we have those values, we can play around with <a href="https://en.wikipedia.org/wiki/Modulo_operation">modulo</a>
<sup>%</sup> math to find some cool stuff.</p>
<p>The first order of business is to eliminate any photos taken at nighttime,
because they're all too dark to be useful.  Using <code>1396020890</code> as an example...</p>
<div class="codehilite"><pre><span></span>    1396020890 % 86400 = 56090
</pre></div>


<p><code>86400</code> is the number of seconds in a day, and what this operation does is
essentially remove the day/month/year components.  What's left is the time
since the stroke of midnight (still in seconds).</p>
<figure>
    <div role="math">
        \dfrac{56090 seconds since midnight}{3600 seconds/hour}
    </div>
</figure>

<p>Dividing </p>
<div class="codehilite"><pre><span></span>time = 1396020890
seconds_after_midnight = time % day # gives us the number of seconds after midnight
hours_after_midnight = (seconds_after_midnight) / hour # gives us the number of hours after midnight
local_hour = hours_after_midnight - 4 # I&#39;m in EST, so -4 GMT
if local_hour &lt; 7  or local_hour &gt; 20: skip
</pre></div>


<h2>Loops vs cron</h2>
<p>The script contains an infinite loop with a 5m <code>sleep</code> command.  Thus the
pictures weren't taken every 5 minutes, but rather every 5-and-some-change
minutes.  This drift doesn't matter for intervals several minutes long, or
longer, but if the interval were much shorter, it could be a big problem.  An
interval of 5m + 5s drift isn't a big deal.</p>
<p>With my D600 I take timelapses with intervals of 10 seconds.  There's no drift
with my intervalometer, but I couldn't take a timelapse that tight with my
current raspi timelapse script.  The drift would add about 50% to the interval,
throwing the ending framerate off completely.</p>
<p><link rel="stylesheet" type="text/css" href="/static/js/katex/katex.min.css">
<script src="/static/js/katex/katex.min.js"></script>
<script>
    function set_vimeo_iframe_height() {
        var ifr = document.getElementById('dimo-demo');
        ifr.height = ifr.offsetWidth / (1280/720);
    }
    document.addEventListener('DOMContentLoaded', set_vimeo_iframe_height);
    window.addEventListener('resize', set_vimeo_iframe_height);
    function render_math() {
        katex.render(this.innerHTML, this);
    }
    $('[role=math]').each(render_math);
</script></p>
        </div>

        <!-- /.entry-content -->

        <footer>
            <small>
                This article was published on
                <time datetime="2014-05-15" pubdate="">2014-05-15</time>
                by <a href="https://twitter.com/mwcz" title="mwcz twitter" rel="author">mwcz</a>
                and tagged with
                    <a href="https://palebluepixel.org/tag/programming" rel="category">programming</a>,                    <a href="https://palebluepixel.org/tag/raspberry pi" rel="category">raspberry pi</a>,                    <a href="https://palebluepixel.org/tag/photography" rel="category">photography</a>,                    <a href="https://palebluepixel.org/tag/timelapse" rel="category">timelapse</a>, and                    <a href="https://palebluepixel.org/tag/camera" rel="category">camera</a>.
            </small>
        </footer>




    </article>

</main>


<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://palebluepixel.org/theme/js/bootstrap.min.js"></script>
<script src="https://palebluepixel.org/theme/lib/prism/prism.js"></script>

</body>
</html>