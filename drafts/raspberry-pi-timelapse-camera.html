<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>    Raspberry Pi Timelapse Camera
</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



    <!--[if gte IE 9]
    <style type="text/css">
        .gradient {
            filter: none;
        }
    </style>
    <![endif]-->

            <link href="http://palebluepixel.org/theme/css/styles.min.css?1664d5e3" rel="stylesheet">

    <!-- JavaScript plugins (requires jQuery) -->
    <script src="http://palebluepixel.org/theme/js/jquery.min.js"></script>

        <link href="http://palebluepixel.org/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Pale Blue Pixel ATOM Feed"/>
        <link href="http://palebluepixel.org/feeds/rss.xml" type="application/atom+xml" rel="alternate"
              title="Pale Blue Pixel RSS Feed"/>


</head>
<body>
<div class="container">
    <nav class="pbp-navbar" role="navigation">
        
        <a href="/">
            <img class="pbp-logo" src="http://palebluepixel.org/theme/images/logo.svg" />
        </a>
    </nav>
</div>
<!-- /.navbar -->
<main role="main" class="container">
    <article>
        <header class="page-header">
            <h2>
                Raspberry Pi Timelapse Camera
            </h2>
        </header>
        <div class="entry-content">
            <nav class="toc"></nav>
            <p>I built a timelapse camera with a raspberry pi.</p>
<p>Hardware:</p>
<ul>
<li><a href="http://amzn.com/B008YE0HAW">A small gorillapod</a></li>
<li><a href="http://www.raspberrypi.org/product/camera-module/">Raspbery Pi camera</a></li>
</ul>
<p>Software:</p>
<p>The scripts I wrote are pretty hasty.  I should tidy them up before publishing
this post.</p>
<p><img alt="Timelapse scene" src="/static/images/028/scene_morning_light.jpg" title="Timelapse scene" /></p>
<p>I didn't secure the pi very well when I first framed the shot, and it wound up
getting bumped several times.  After being bumped, it would continue to take
shots for hours (or days).</p>
<p>After compiling all the still images into a video, the bumps are extremely
jarring.  To alleviate that problem, I used <a href="http://public.hronopik.de/vid.stab/features.php?lang=en" title="video stabilization in linux">Georg Martius' vid.stab</a> to
stabilize the video.</p>
<h2 id="file-naming">File naming</h2>
<p>I used Epoch times as filenames.</p>
<pre><code>1396020890.jpg
1396021196.jpg
1396021502.jpg
1396021808.jpg
</code></pre>
<p>This was a spontaneous decision, but turned out to have some unexpected
benefits.  Eliminating night-time shots was one of them, since it involved only
some pretty simple algebra, and no messy date math.</p>
<p>Doing some modulo math on the epoch times made isolating the dark hours easy.
All we need to know is the number of seconds in a minute, hour, and day.</p>
<pre><code>minute = 60
hour   = 3600
day    = 86400
</code></pre>
<p>Let's say we want to eliminate any shot taken between 8 PM and 7 AM.  Take the
first timelapse shot above, <code>1396020890</code>.</p>
<pre><code>time = 1396020890
seconds_after_midnight = time % day # gives us the number of seconds after midnight
hours_after_midnight = (seconds_after_midnight) / hour # gives us the number of hours after midnight
local_hour = hours_after_midnight - 4 # I'm in EST, so -4 GMT
if local_hour &lt; 7  or local_hour &gt; 20: skip
</code></pre>
<h2 id="loops-vs-cron">Loops vs cron</h2>
<p>The script contains an infinite loop with a 5m <code>sleep</code> command.  Thus the
pictures weren't taken every 5 minutes, but rather every 5-and-some-change
minutes.  This drift doesn't matter for intervals several minutes long, or
longer, but if the interval were much shorter, it could be a big problem.  An
interval of 5m + 5s drift isn't a big deal.</p>
<p>With my D600 I take timelapses with intervals of 10 seconds.  There's no drift
with my intervalometer, but I couldn't take a timelapse that tight with my
current raspi timelapse script.  The drift would add about 50% to the interval,
throwing the ending framerate off completely.</p>
        </div>

        <!-- /.entry-content -->
    </article>

</main>


<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://palebluepixel.org/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://palebluepixel.org/theme/js/respond.min.js"></script>
</body>
</html>