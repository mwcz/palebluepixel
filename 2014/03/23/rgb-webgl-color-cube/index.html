<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>    RGB WebGL Color Cube - Pale Blue Pixel
</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



    <!--[if gte IE 9]
    <style type="text/css">
        .gradient {
            filter: none;
        }
    </style>
    <![endif]-->

    <!-- <link href='http://fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'> -->
            <link href="http://palebluepixel.org/theme/css/styles.min.css?c9792ac2" rel="stylesheet">

    <!-- JavaScript plugins (requires jQuery) -->
    <script src="http://palebluepixel.org/theme/js/jquery.min.js"></script>

        <link href="http://palebluepixel.org/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Pale Blue Pixel ATOM Feed"/>
        <link href="http://palebluepixel.org/feeds/rss.xml" type="application/atom+xml" rel="alternate"
              title="Pale Blue Pixel RSS Feed"/>


</head>
<body>
<nav class="pbp-navbar" role="navigation">
    <a href="http://palebluepixel.org" title="Pale Blue Pixel homepage" id="pbp-logo">
        PALE BL<span class="pbp-dot">&middot;</span>UE PIXEL
    </a>
</nav>
<!-- /.navbar -->
<main role="main" class="container">
    <article>
        <header class="page-header">
            <h1>
                RGB WebGL Color Cube
            </h1>
        </header>
        <div class="entry-content">
            <nav class="toc"></nav>
            <p>I spent a bit of time this weekend building an RGB color cube for
<a href="http://colorpal.org">ColorPal</a>, using <a href="http://threejs.org">Three.js</a>.  Drag and drop any image, and you'll see a
cube with all the pixels of your image mapped into 3D space.</p>
<p><a class="btn btn-default btn-lg"
href="/static/projects/colorpal_colorcube">Launch live demo!</a> and <a href="https://github.com/mwcz/mwcz/blob/master/content/static/projects/colorpal_colorcube/js/cp-colorcube.js">view the
code</a>.</p>
<p>Your web browser must support WebGL, which at this point in history means a
fairly recent Firefox or Chrome.  In case your web browser doesn't support
WebGL, here's a video to enjoy while you download <a href="https://nightly.mozilla.org/">Firefox Nightly</a>. ;)</p>
<figure>

    <iframe id="colorcube-demo" src="//player.vimeo.com/video/108080970"
    width="100%" frameborder="0" webkitallowfullscreen mozallowfullscreen
    allowfullscreen></iframe>

    <figcaption>
        A <a href="http://vimeo.com/107405612">recording</a> of the colorcube
        with a couple of sample images, including the <a
        href="http://colorpal.org/" title="ColorPal, a color palette
        generator">ColorPal</a> logo.
    </figcaption>
</figure>

<p><a href="http://threejs.org">Three.js</a> has proven to be pretty fun.  The documentation is decent, but
not comprehensive.  Some parts of the API are filled with "todo" notes instead
of actual documentation.</p>
<p>Luckily, the omissions in the documentation are made up for by the extensive
<a href="http://threejs.org/examples/">set of code examples</a>.  Any time I couldn't get what I needed from the API
docs, I skimmed the examples until I found an existing scene that had the
effect I needed.</p>
<p>For this demo, drawing a cube was easy, and even populating it with dots was easy, but </p>
<h1 id="colored-particles">Colored particles</h1>
<p>The color cube uses a particle system to render 2D color points inside a 3D
cube.</p>
<p>Eventually I found a <a href="http://threejs.org/examples/#webgl_particles_billboards_colors">particle system demo with colors</a>, which held the key.</p>
<p>By setting <code>vertexColors: true</code> on the <code>ParticleSystemMaterial</code>, Three.js will
match each vertex in the <code>vertices</code> array with a color in the <code>colors</code> array.
<code>vertices[1726]</code> will use <code>colors[1726]</code>, for example.</p>
<p><img alt="Screenshot of ColorCube" src="/static/images/025/screenshot.png" title="Screenshot of ColorCube" /></p>
<p>A vertex and a color are created for each pixel in the source image.  For the
vertex, <span style="color: red;">red</span> values are mapped to the <code>X</code> axis,
and similarly <span style="color: green">green</span> to <code>Y</code> and <span
style="color: blue">blue</span> to <code>Z</code>.</p>
<h1 id="optimization">Optimization</h1>
<p>Rendering a point for each pixel in a huge image image would be overkill, so
I used the pixel culling already present in ColorPal to scale the number of
points down to a more reasonable 128<sup>2</sup>.  Increasing that number also
increases the quality of the cube.  If you look closely in the video above, the
ColorPal logo cube has gaps in it.  The better the quality, the longer the
startup time, though.</p>
<p>Now I'm racking my brain for an excuse to use WebGL at Red Hat...</p>
<p>Any ideas?</p>
<script>
    function set_vimeo_iframe_height() {
        var ifr = document.getElementById('colorcube-demo');
        ifr.height = ifr.offsetWidth / (1280/720);
    }
    document.addEventListener('DOMContentLoaded', set_vimeo_iframe_height);
    window.addEventListener('resize', set_vimeo_iframe_height);
</script>
        </div>

        <!-- /.entry-content -->

        <footer>
            <small>
                This article was published on
                <time datetime="2014-03-23" pubdate="">2014-03-23</time>
                by <a href="https://twitter.com/mwcz" title="mwcz twitter" rel="author">mwcz</a>
                and tagged with
                    <a href="http://palebluepixel.org/tag/html5" rel="category">html5</a>,                    <a href="http://palebluepixel.org/tag/javascript" rel="category">javascript</a>,                    <a href="http://palebluepixel.org/tag/color" rel="category">color</a>,                    <a href="http://palebluepixel.org/tag/colorpal" rel="category">colorpal</a>,                    <a href="http://palebluepixel.org/tag/webgl" rel="category">webgl</a>, and                    <a href="http://palebluepixel.org/tag/web" rel="category">web</a>.
            </small>
        </footer>


    </article>

</main>


<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://palebluepixel.org/theme/js/bootstrap.min.js"></script>
<script src="http://palebluepixel.org/theme/lib/prism/prism.js"></script>

</body>
</html>