<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <title>HTML5 Canvas eyedropper</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="/static/css/syntax.css">

    <link rel="stylesheet" type='text/css' href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" type='text/css' href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/3.2.1/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Lato">

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.js" type="application/javascript" charset="utf-8"></script>

    <!-- Custom CSS -->
    <style type="text/css" media="screen">
        body { font-family: 'Lato', sans-serif; }
        @media (min-width: 768px) {
            .container {
                max-width: 930px;
            }
        }
        .header {
            text-shadow: 0px 1px 2px rgba(0,0,0,0.1);
        }
        .header .nav-pills .glyphicon {
            position : relative;
            top      : 2px;
            left     : -2px;
            color    : black;
        }
        .clayto-photo-list img {
            width: 100%;
        }
        .clayto-project-list img {
            margin: 0 auto;
        }
    </style>

</head>
<body>

    <div class="container">
        <div class="header">
            <ul class="nav nav-pills pull-right">
                <li>
                    <a href="/">
                        <span class="glyphicon glyphicon-globe"></span>
                        Home
                    </a>
                </li>
                <li>
                    <a href="/blog">
                        <span class="glyphicon glyphicon-floppy-disk"></span>
                        Tech
                    </a>
                </li>
                <li>
                    <a href="/photos">
                        <span class="glyphicon glyphicon-camera"></span>
                        Photos
                    </a>
                </li>
                <li>
                    <a href="/about">
                        <span class="glyphicon glyphicon-barcode"></span>
                        About
                    </a>
                </li>
            </ul>
            <h1 class="text-muted">clayto.com</h1>
        </div>
        <div class="row">
            <div class="col-md-12">
                <h2>HTML5 Canvas eyedropper</h2>
<p>16 Nov 2011</p>

<div>
<style type="text/css"> 
    canvas { margin: 0 auto; }
</style> 

<script type="text/javascript"> 
 
var c;
var cnvs;
 
window.onload = function() {
 
    cnvs = document.getElementById("c");
    
    if( cnvs.getContext) { // Check for canvas support
    // DRAW FUN STUFF!  
 
        c = cnvs.getContext('2d');
        var color = document.getElementById("color");
        var colorcode = document.getElementById("colorcode");
 
        var images = new Image();
 
        images.onload = function() {
            cnvs.width = images.width;cnvs.height = images.height; // resize to fit image
            c.drawImage( images, 0, 0 );
        }
        images.src = "/static/images/001/kazoo.png";
 
        pixel = function(e) {

            // find the element's position
            var x = 0;
            var y = 0;
            var o = cnvs;
            do {
                x += o.offsetLeft;
                y += o.offsetTop;
            } while (o = o.offsetParent);

            x = e.pageX - x;
            y = e.pageY - y;
            var imagesdata = c.getImageData( x, y, 1, 1 );
            var new_color = [ imagesdata.data[0], imagesdata.data[1], imagesdata.data[2] ];
            document.body.style.background = "rgb("+new_color+")";
            colorcode.innerHTML = "rgb("+new_color+")";
        }
 
        cnvs.onmousedown = function(e) {
            cnvs.onmousemove = pixel; // fire pixel() while user is dragging
            cnvs.onclick = pixel; // only so it will still fire if user doesn't drag at all
        }
 
        cnvs.onmouseup = function() {
            cnvs.onmousemove = null;
        }
 
    }
 
}
 
</script> 

<p>This is an old demo I made of an <a href="http://en.wikipedia.org/wiki/Canvas_element">HTML5 canvas</a> eyedropper.  Circa 2009, I believe.  Just click and drag on the image to see it in action.</p>

<p><span id="colorcode">rgb(0,0,0)</span></p>

<p><canvas id="c">Sorry, in order to view this demo you need a Web browser that supports HTML5 canvas.</canvas></p>

<p>It&#39;s a pretty simple script, and works by declaring this function which handles onclick and ondrag events from the canvas.  cnvs is the canvas element, and c is the canvas&#39;s 2D rendering context object.</p>

<div class="highlight"><pre><code class="js"><span class="nx">pixel</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// calculate the x and y coordinates of the cursor</span>
    <span class="kd">var</span> <span class="nx">imagesdata</span> <span class="o">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">getImageData</span><span class="p">(</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="p">);</span>
    <span class="kd">var</span> <span class="nx">new_color</span> <span class="o">=</span> <span class="p">[</span> <span class="nx">imagesdata</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                      <span class="nx">imagesdata</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
                      <span class="nx">imagesdata</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">];</span>
    <span class="nx">color</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">background</span> <span class="o">=</span> <span class="s2">&quot;rgb(&quot;</span><span class="o">+</span><span class="nx">new_color</span><span class="o">+</span><span class="s2">&quot;)&quot;</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p>That&#39;s just a summary; the function actually does a little more than that.  Take a look at the source for this page if you&#39;re interested, and contact me if there are any questions.</p>

</div>

            </div>
        </div>
        <div class="footer text-center">
            <hr />
            <!-- I <3 -->
            <i class="text-danger glyphicon glyphicon-heart" title="Made with &hearts; by Michael Clayton in Raleigh"></i>
            <hr />
        </div>
    </div>

    <script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.0.0/js/bootstrap.min.js" type="application/javascript" charset="utf-8"></script>
</body>
</html>
