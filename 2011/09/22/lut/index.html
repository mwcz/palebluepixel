<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>    LUT - Pale Blue Pixel
</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#171717">
    <link rel="icon" type="image/png" href="/static/images/favicon.png">


        <!-- Open Graph tags -->
            <meta property="og:type" content="article"/>
            <meta property="og:title" content="LUT"/>
            <meta property="og:url" content="https://palebluepixel.org/2011/09/22/lut/"/>
            <meta property="og:description" content="Decoding is easy. Decoding requires a lot of typing. (I am starting to believe this is true of ever aspect â€¦"/>


    <!--[if gte IE 9]
    <style type="text/css">
        .gradient {
            filter: none;
        }
    </style>
    <![endif]-->

    <!-- <link href='http://fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'> -->
    <link href="https://palebluepixel.org/theme/css/styles.min.css" rel="stylesheet">

    <!-- JavaScript plugins (requires jQuery) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js"></script>
    <script>window.jQuery = $;</script>

    <link href="https://palebluepixel.org/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
          title="Pale Blue Pixel ATOM Feed"/>
    <link href="https://palebluepixel.org/feeds/rss.xml" type="application/atom+xml" rel="alternate"
          title="Pale Blue Pixel RSS Feed"/>


</head>
<body>
<div class="container">
    <nav class="pbp-navbar" role="navigation">
        <a href="https://palebluepixel.org" title="Pale Blue Pixel homepage" id="pbp-logo">
            PALE BL<span class="pbp-dot">&middot;</span>UE PIXEL
        </a>
        <ul class="pbp-navitems">
            <li class="pbp-navitem">
                <a href="/projects" class="pbp-navlink">Projects</a>
            </li>
            <li class="pbp-navitem">
                <a href="/posts" class="pbp-navlink">Blog</a>
            </li>
        </ul>
    </nav>
</div>
<!-- /.navbar -->
<main role="main" class="container">
    <article>


        <header class="page-header">
            <h1>
                LUT
            </h1>
        </header>
        <div class="entry-content">
            <nav class="toc"></nav>
            <p>Decoding is easy. Decoding requires a lot of typing. (I am starting to believe this is true of ever aspect of interpreted emulation...)</p>
<p>For the AEJS decoder, I am creating a <a href="http://en.wikipedia.org/wiki/Lookup_table">look-up table</a> with every possible pattern for each instruction. It was my first idea, but I initially discarded it as "wasteful and inelegant". Later, I accepted it as "really fast".</p>
<p>I'm generating a large set of bit patterns that map to 68k opcodes, like so:</p>
<div class="codehilite"><pre><span></span>0100101011111010 -&gt; BGND
0100101011111100 -&gt; ILLEGAL
0100111001110000 -&gt; RESET
0100111001110001 -&gt; NOP
0100111001110010 -&gt; STOP
0100111001110011 -&gt; RTE
</pre></div>


<p>The current code can be found <a href="https://github.com/mwcz/AEJS/blob/master/src/genlut.py">here</a>.</p>
<p>Yes, it's written in Python and yes, AEJS is a JavaScript project.  There's a reason.  I see two approaches to generating the LUT (look-up table).</p>
<h2>Generate the LUT on launch (dynamic)</h2>
<p>This has the advantage of being easier to debug.  It also might be easier if I ever expand the emulator to other chips, like the <a href="http://en.wikipedia.org/wiki/Motorola_68020">68020</a> or <a href="http://en.wikipedia.org/wiki/Motorola_68030">68030</a>.</p>
<p>It currently takes about 0.466 seconds on my machine to generate ~12,000 patterns.  That means it should take less than 2.5s to generate the full LUT.</p>
<h2>Generate the LUT pre-launch (static)</h2>
<p>This is what I'm currently working toward.  genlut.py is currently generating about 12,000 opcode bit patterns out of a max of I'm-not-sure-yet-but-slightly-less-than-65,536.</p>
<p>With this method, I would run genlut.py one final time, pipe the output into a static JS file, and regex the contents into a JS array.  The LUT would never have to be generated again, and would exist happily forever-after.</p>
<p>Cons: relies upon the LUT being 100% correct, as any errors would be hard to debug, and would require another run of genlut.py to fix.</p>
<p>Pros: AEJS will launch faster without having to generate the LUT each time.  If I can verify that the LUT is 100% correct, this is obviously the right approach.</p>
<p>I'll continue on with the static method for now, and odds are I'll stick with it.   2.5s is too big a price to pay.</p>
<p>Back to work:</p>
<p><a href="https://palebluepixel.org/2011/09/22/lut/workarea.png"><img class="grid_7" src="https://palebluepixel.org/2011/09/22/lut/workarea.png" alt=":)" title="" /></a>
<div class="clear"></div></p>
<p>(This post was copied from my old <a href="http://aejs.blogspot.com/">AEJS blog</a>)</p>
        </div>

        <!-- /.entry-content -->

        <footer class="pbp-article-footer">
            <small>
                This article was published on
                <time datetime="2011-09-22" pubdate="">2011-09-22</time>
                by <a href="https://twitter.com/mwcz" title="mwcz twitter" rel="author">mwcz</a>
                and tagged with
                    <a href="https://palebluepixel.org/tag/aejs" rel="category">aejs</a>,                    <a href="https://palebluepixel.org/tag/html5" rel="category">html5</a>,                    <a href="https://palebluepixel.org/tag/javascript" rel="category">javascript</a>,                    <a href="https://palebluepixel.org/tag/amiga" rel="category">amiga</a>, and                    <a href="https://palebluepixel.org/tag/web" rel="category">web</a>.
            </small>
        </footer>



    <script src="https://apis.google.com/js/plusone.js">
    </script>
    <div class="g-comments"
        data-href="https://palebluepixel.org/2011/09/22/lut/"
        data-width="642"
        data-first_party_property="BLOGGER"
        data-view_type="FILTERED_POSTMOD">
    </div>


    </article>

</main>


<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://palebluepixel.org/theme/js/bootstrap.min.js"></script>
<script src="https://palebluepixel.org/theme/lib/prism/prism.js"></script>

</body>
</html>