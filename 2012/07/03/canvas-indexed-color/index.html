<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>Canvas Indexed Color</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Open Graph tags -->

            <meta property="og:type" content="article"/>
            <meta property="og:title" content="Canvas Indexed Color"/>
            <meta property="og:url" content="http://localhost:8000/2012/07/03/canvas-indexed-color/"/>
            <meta property="og:description" content="Canvas Indexed Color demo First, I converted the classic SVG tiger into a set of canvas drawing instructions using Professor Cloud's conversion tool. The output looks like this. Each call to cvm.getColor() used to be a ..."/>

    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://localhost:8000/theme/css/bootstrap.flatly.min.css" type="text/css"/>
    <link href="http://localhost:8000/theme/css/font-awesome.min.css" rel="stylesheet">
    <link href="http://localhost:8000/theme/css/pygments.css" rel="stylesheet">
    <link rel="stylesheet" href="http://localhost:8000/theme/css/style.css" type="text/css"/>
    <!-- JavaScript plugins (requires jQuery) -->
    <script src="http://code.jquery.com/jquery.js"></script>

        <link href="http://localhost:8000/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="mwcz.org - a blog ATOM Feed"/>
        <link href="http://localhost:8000/feeds/rss.xml" type="application/atom+xml" rel="alternate"
              title="mwcz.org - a blog RSS Feed"/>

</head>
<body>
<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://localhost:8000" class="navbar-brand">mwcz.org - a blog</a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                        <li><a href="http://localhost:8000/projects/">Projects</a></li>
                        <li class="active">
                            <a href="http://localhost:8000/category/blog/">blog</a>
                        </li>
                        <li >
                            <a href="http://localhost:8000/category/photos/">photos</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="http://localhost:8000/archives/"><i class="icon-th-list"></i>Archives</a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</nav>
<!-- /.navbar -->
<div class="container">
    <div class="row">
        <div class="col-lg-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://localhost:8000/2012/07/03/canvas-indexed-color/"
                       rel="bookmark"
                       title="Permalink to Canvas Indexed Color">
                        Canvas Indexed Color
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="icon-calendar"></i>Tue 03 July 2012
    </span>



<span class="label label-default">Tags</span>
	<a href="http://localhost:8000/tag/html5/">html5</a>
        /
	<a href="http://localhost:8000/tag/canvas/">canvas</a>
        /
	<a href="http://localhost:8000/tag/color/">color</a>
</footer><!-- /.post-info -->                    </div>
                </div>
                <p><a href="/projects/canvas_indexed_color" title="Canvas Indexed Color demo">Canvas Indexed Color demo</a></p>
<p><img alt="White SVG Tiger" src="/static/images/021/hahatiger.png" /></p>
<p>First, I converted the classic SVG tiger into a set of canvas drawing
instructions using <a href="http://professorcloud.com/svg-to-canvas/" title="Professor Cloud's conversion
tool">Professor Cloud's conversion
tool</a>.  The output looks like
<a href="https://github.com/mwcz/mwcz/blob/master/blog/projects/canvas_indexed_color/vector_images.js" title="Tiger image">this</a>.  Each call to <code>cvm.getColor()</code> used to be a string literal.  </p>
<p>Vim's regex saved me from having to edit <em>100,000</em> lines of canvas instructions
by hand to replace the color strings.</p>
<p>The demo uses <a href="http://knockoutjs.com/" title="Knockout JS">Knockout</a> for handling all
the update/draw events as well as updating the URL hash.  Check the <a href="https://github.com/mwcz/mwcz/blob/master/blog/projects/canvas_indexed_color/cic.js" title="source code">source
code</a> and you'll see that there <em>isn't</em> a vast tangled nest of event
wirings.  Each time one of the colors in this ViewModel is changed, Knockout
automatically triggers the canvas redraw and the updates the URL with the new
palette.  Conversely, if the URL is changed, the ViewModel will update itself
with the new value.  Knockout calls this a "two-way data binding".  </p>
<p>I replaced the aforementioned color strings with calls to <code>cvm</code>, which is a
Knockout ViewModel (in this case, an object that holds all the color data).
<code>cvm</code> is populated with the SVG tiger's default colors.</p>
<div class="highlight"><pre><span class="nt">ko</span><span class="nc">.observableArray</span><span class="o">(</span> <span class="cp">[</span>
    <span class="p">{</span> <span class="nx">hex</span><span class="p">:</span> <span class="nx">ko.observable</span><span class="p">(</span><span class="s2">&quot;#000000&quot;</span><span class="p">)</span> <span class="p">},</span>
    <span class="p">{</span> <span class="nx">hex</span><span class="p">:</span> <span class="nx">ko.observable</span><span class="p">(</span><span class="s2">&quot;#323232&quot;</span><span class="p">)</span> <span class="p">},</span>
    <span class="c1">// .... many more ....</span>
    <span class="p">{</span> <span class="nx">hex</span><span class="p">:</span> <span class="nx">ko.observable</span><span class="p">(</span><span class="s2">&quot;#ff727f&quot;</span><span class="p">)</span> <span class="p">},</span>
    <span class="p">{</span> <span class="nx">hex</span><span class="p">:</span> <span class="nx">ko.observable</span><span class="p">(</span><span class="s2">&quot;#ffffff&quot;</span><span class="p">)</span> <span class="p">}</span>
<span class="cp">]</span><span class="o">);</span>
</pre></div>


<p>Play with the colors, then copy the URL and send your tiger to your friends.  :]</p>
<p><a href="/projects/canvas_indexed_color/#4c0000,#659900,#666666,#992600,#999999,#99cc32,#a51926,#a5264c,#b23259,#b26565,#b2b2b2,#cc3f4c,#cc7226,#cccccc,#e5668c,#e59999,#e5e5b2,B5E8E6,#ea8c4d,#ea8e51,#eb955c,#ec9961,#eea575,#efaa7c,#f1b288,#f2b892,#f3bf9c,#f4c6a8,#f5ccb0,#f8d8c4,#f8dcc8,#f9e2d3,#fae5d7,#fcf2eb,#ff727f,#ffffcc,#ffffff,#000000,#323232" title="Crazy tiger">Crazy tiger</a>.</p>
<p>Please note, this is only a simulation of an indexed color palette.  It is not
a true, usable, indexed-color API for canvas (someday, maybe!).</p>
<p>The color picker is <a href="https://github.com/mattfarina/farbtastic" title="Farbtastic">Farbtastic</a>.  If you're interested in reading more about the history of
indexed color, and a <strong>mind-blowing</strong> canvas demo, go
<a href="http://www.effectgames.com/effect/article.psp.html/joe/Old_School_Color_Cycling_with_HTML5" title="Color cycling in HTML5 canvas">here</a>.</p>
            </div>
            <!-- /.entry-content -->
    <hr />
    <section class="comments" id="comments">
        <h2>Comments</h2>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'mwcz'; // required: replace example with your forum shortname
            var disqus_identifier = 'canvas-indexed-color';
            var disqus_url = 'http://localhost:8000/2012/07/03/canvas-indexed-color/';

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-lg-3 well well-sm" id="sidebar">
<aside>
    <section>
        <ul class="list-group list-group-flush">
                <li class="list-group-item"><h4><i class="icon-home icon-large"></i>Social</h4></li>
                    <li class="list-group-item"><a href="https://github.com/mwcz"><i
                            class="icon-GitHub-sign icon-large"></i>GitHub
                    </a></li>
                    <li class="list-group-item"><a href="https://twitter.com/mwcz"><i
                            class="icon-Twitter-sign icon-large"></i>Twitter
                    </a></li>



            <li class="list-group-item"><a href="http://localhost:8000/tags.html"><h4><i class="icon-tags icon-large"></i>Tags</h4></a></li>
                <li class="list-group-item tag-0">
                    <a href="http://localhost:8000/tag/html5/">
                        html5
                    </a>
                </li>
                <li class="list-group-item tag-1">
                    <a href="http://localhost:8000/tag/canvas/">
                        canvas
                    </a>
                </li>
                <li class="list-group-item tag-1">
                    <a href="http://localhost:8000/tag/color/">
                        color
                    </a>
                </li>
                <li class="list-group-item tag-1">
                    <a href="http://localhost:8000/tag/javascript/">
                        javascript
                    </a>
                </li>
                <li class="list-group-item tag-2">
                    <a href="http://localhost:8000/tag/jsimage/">
                        jsimage
                    </a>
                </li>
                <li class="list-group-item tag-2">
                    <a href="http://localhost:8000/tag/aejs/">
                        aejs
                    </a>
                </li>
                <li class="list-group-item tag-2">
                    <a href="http://localhost:8000/tag/amiga/">
                        amiga
                    </a>
                </li>
                <li class="list-group-item tag-2">
                    <a href="http://localhost:8000/tag/colorpal/">
                        colorpal
                    </a>
                </li>
                <li class="list-group-item tag-3">
                    <a href="http://localhost:8000/tag/physics/">
                        physics
                    </a>
                </li>
                <li class="list-group-item tag-3">
                    <a href="http://localhost:8000/tag/bouncey/">
                        bouncey
                    </a>
                </li>
                <li class="list-group-item tag-3">
                    <a href="http://localhost:8000/tag/general/">
                        general
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a href="http://localhost:8000/tag/mwczorg/">
                        mwcz.org
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a href="http://localhost:8000/tag/django/">
                        django
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a href="http://localhost:8000/tag/test/">
                        test
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a href="http://localhost:8000/tag/typography/">
                        typography
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a href="http://localhost:8000/tag/python/">
                        python
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a href="http://localhost:8000/tag/testing/">
                        testing
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a href="http://localhost:8000/tag/linux/">
                        linux
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a href="http://localhost:8000/tag/git/">
                        git
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a href="http://localhost:8000/tag/bootstrap/">
                        bootstrap
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a href="http://localhost:8000/tag/vim/">
                        vim
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a href="http://localhost:8000/tag/stackoverflow/">
                        stackoverflow
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a href="http://localhost:8000/tag/image-processing/">
                        image processing
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a href="http://localhost:8000/tag/bash/">
                        bash
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a href="http://localhost:8000/tag/n9/">
                        n9
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a href="http://localhost:8000/tag/photo/">
                        photo
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a href="http://localhost:8000/tag/css3/">
                        css3
                    </a>
                </li>
                <li class="list-group-item tag-4">
                    <a href="http://localhost:8000/tag/keepass/">
                        keepass
                    </a>
                </li>
        </ul>
    </section>


    <section>
    <ul class="list-group list-group-flush">
    <li class="list-group-item"><h4><i class="icon-github icon-large"></i>GitHub Repos</h4></li>
        <div id="gh_repos">
            <p class="list-group-item">Status updating...</p>
        </div>
    </ul>
        <script type="text/javascript">
            $(document).ready(function () {
                if (!window.jXHR) {
                    var jxhr = document.createElement('script');
                    jxhr.type = 'text/javascript';
                    jxhr.src = 'http://localhost:8000/theme/js/jXHR.js';
                    var s = document.getElementsByTagName('script')[0];
                    s.parentNode.insertBefore(jxhr, s);
                }

                github.showRepos({
                    user: 'mwcz',
                    count: 5,
                    skip_forks: true,
                    target: '#gh_repos'
                });
            });
        </script>
        <script src="http://localhost:8000/theme/js/github.js" type="text/javascript"></script>
    </section>
</aside>        </div>
    </div>
</div>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://localhost:8000/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://localhost:8000/theme/js/respond.min.js"></script>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'mwcz'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
</body>
</html>